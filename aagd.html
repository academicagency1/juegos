<!DOCTYPE html>
<html lang="en-US">
<head>
    <title>Google Classroom</title>
    <link rel="icon" type="image/png" href="https://ssl.gstatic.com/classroom/favicon.png">
    <base href="https://rawcdn.githack.com/genizy/google-class/main/gdlite/">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        html, body {
            margin: 0; padding: 0; width: 100vw; height: 100vh;
            overflow: hidden; background: #000;
            /* Force GPU rendering */
            transform: translateZ(0);
        }
        #gameContainer {
            width: 100%; height: 100%;
            /* Improves rendering speed on some browsers */
            image-rendering: optimizeSpeed; 
        }
        #loader {
            position: absolute; left: 0; top: 0; width: 100%; height: 100%;
            display: flex; flex-direction: column; align-items: center;
            justify-content: center; background: linear-gradient(#000, #0066ff);
            z-index: 10;
        }
        .logo { max-width: 80%; max-height: 50%; }
        .progress { width: 300px; height: 20px; border: 2px solid #fff; margin-top: 20px; display: none; }
        .full { background: #fff; height: 100%; width: 0%; transition: width 0.1s; }
    </style>
</head>
<body>
    <div id="gameContainer"></div>
    <div id="loader">
        <img class="logo" src="image/loading.png">
        <div class="progress"><div class="full"></div></div>
    </div>

    <script src="Build/UnityLoader.js"></script>
    <script>
        // Optimization: Set WebGL parameters before loading
        var gameInstance = UnityLoader.instantiate("gameContainer", "Build/GeometryDashLite.json", {
            onProgress: UnityProgress,
            Module: {
                // Performance boost: disables unnecessary smoothing
                preRun: [],
                postRun: [],
                canvas: (function() {
                    var canvas = document.createElement('canvas');
                    canvas.addEventListener("webglcontextlost", function(e) { e.preventDefault(); }, false);
                    return canvas;
                })()
            }
        });

        function UnityProgress(gameInstance, progress) {
            if (!gameInstance.Module) return;
            const loader = document.querySelector("#loader");
            const progressBar = document.querySelector(".progress");
            const fullBar = document.querySelector(".full");
            
            progressBar.style.display = "block";
            fullBar.style.width = (progress * 100) + "%";

            if (progress === 1) {
                setTimeout(() => { loader.style.display = "none"; }, 1500);
            }
        }

        // PANIC BUTTON (-)
        document.addEventListener('keydown', function(e) {
            if (e.key === '-') {
                window.location.href = "https://classroom.google.com";
            }
        });
    </script>
</body>
</html>
